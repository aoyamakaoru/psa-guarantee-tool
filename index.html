<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>PSAåˆ©ç›Šè¨ˆç®—ãƒ„ãƒ¼ãƒ«</title>

<style>
body{
  font-family:system-ui;
  margin:0;
  padding:16px;
  background:#f5f5f5;
}

.wrap{
  margin:auto;
}

.view-mobile .wrap{
  width:390px;
  margin:auto;
}

.view-pc .wrap{
  max-width:900px;
  margin:auto;
}

h1{
  font-size:18px;
  margin-bottom:10px;
}

.viewbar{
  display:flex;
  justify-content:space-between;
  margin-bottom:10px;
}

.segbtn{
  padding:8px 12px;
  border-radius:10px;
  border:none;
  background:#ddd;
}

.segbtn.active{
  background:#111;
  color:#fff;
}

input{
  width:100%;
  padding:10px;
  margin-bottom:8px;
  border-radius:10px;
  border:1px solid #ccc;
}

button{
  padding:10px;
  border-radius:10px;
  border:none;
}

.primary{background:#111;color:#fff;}
.ghost{background:#eee;}

.out{
  margin-top:10px;
  padding:14px;
  border-radius:14px;
  background:#fff;
}

.big{
  font-size:18px;
  font-weight:bold;
}

.ok{color:green;}
.warn{color:red;}
</style>
</head>

<body class="view-mobile">

<div class="wrap">

<h1>PSAåˆ©ç›Šè¨ˆç®—ãƒ„ãƒ¼ãƒ«</h1>

<div class="viewbar">
  <div>
    <button id="btnMobile" class="segbtn active">ã‚¹ãƒãƒ›</button>
    <button id="btnPC" class="segbtn">PC</button>
  </div>
  <button id="copyBtn">çµæœã‚³ãƒ”ãƒ¼</button>
</div>

<input id="card" type="number" placeholder="ã‚«ãƒ¼ãƒ‰ä»£">
<input id="grading" type="number" placeholder="é‘‘å®šè²»ç”¨">
<input id="n" type="number" placeholder="æšæ•°">
<input id="rate10" type="number" placeholder="PSA10ç‡%">
<input id="p10" type="number" placeholder="PSA10è²·å–">
<input id="p9" type="number" placeholder="PSA9è²·å–">
<input id="target" type="number" placeholder="ç›®æ¨™åˆ©ç›Š">

<div style="display:flex;gap:8px;margin-top:8px;">
<button id="calcBtn" class="primary">è¨ˆç®—</button>
<button id="fillBtn" class="ghost">ä¾‹</button>
</div>

<div id="out" class="out">ã“ã“ã«çµæœãŒå‡ºã¾ã™</div>

</div>

<script>
function calc(){
  const c = Number(document.getElementById('card').value) || 0;
  const g = Number(document.getElementById('grading').value) || 0;
  const n = Math.max(1, Number(document.getElementById('n').value) || 1);
  const r10 = Number(document.getElementById('rate10').value) || 0;
  const p10 = Number(document.getElementById('p10').value) || 0;
  const p9 = Number(document.getElementById('p9').value) || 0;
  const target = Number(document.getElementById('target').value) || 0;

  const cost = c + g;
  const diff = p10 - p9;

  let yMax;
  if(diff <= 0){
    yMax = n;
  } else {
    const profitAll10 = n * p10 - n * cost;
    yMax = Math.floor((profitAll10 - target) / diff);
    yMax = Math.max(0, Math.min(n, yMax));
  }

  const min10 = n - yMax;
  const needRate = (min10 / n * 100).toFixed(1);

  const exp10 = n * (r10 / 100);
  const exp9 = n - exp10;
  const expProfit = exp10 * p10 + exp9 * p9 - n * cost;

  const ok = expProfit >= target;

  document.getElementById('out').innerHTML = `
    <div class="big ${ok ? 'ok':'warn'}">
      PSA9ã¯ ${yMax}æšã¾ã§OK
    </div>
    å¿…è¦PSA10ç‡ï¼š${needRate}%<br>
    æœŸå¾…åˆ©ç›Šï¼š${Math.round(expProfit)}å††
  `;
}

// ãƒœã‚¿ãƒ³
document.getElementById('calcBtn').addEventListener('click', calc);

document.getElementById('fillBtn').addEventListener('click', () => {
  document.getElementById('card').value = 3000;
  document.getElementById('grading').value = 2500;
  document.getElementById('n').value = 10;
  document.getElementById('rate10').value = 60;
  document.getElementById('p10').value = 12000;
  document.getElementById('p9').value = 6000;
  document.getElementById('target').value = 0;
  calc();
});

// ã‚³ãƒ”ãƒ¼
document.getElementById('copyBtn').addEventListener('click', () => {
  const text = document.getElementById('out').innerText;
  navigator.clipboard.writeText(text);
  alert("ã‚³ãƒ”ãƒ¼ã—ãŸã§ğŸ‘");
});

// åˆ‡ã‚Šæ›¿ãˆ
document.getElementById('btnMobile').addEventListener('click', () => {
  document.body.className = "view-mobile";
});

document.getElementById('btnPC').addEventListener('click', () => {
  document.body.className = "view-pc";
});
</script>

</body>
</html>
 
