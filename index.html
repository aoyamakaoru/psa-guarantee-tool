<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>PSAæœ€ä½ä¿è¨¼ãƒ„ãƒ¼ãƒ«</title>

<style>
body{
  font-family:system-ui;
  margin:0;
  padding:16px;
  background:#fafafa;
}
.wrap{margin:auto;}

.viewbar{
  display:flex;
  justify-content:space-between;
  margin-bottom:10px;
}
.segbtn{
  padding:8px 12px;
  border-radius:10px;
  border:none;
  background:#ddd;
}
.segbtn.active{
  background:#111;
  color:#fff;
}

.view-mobile .wrap{max-width:420px;}
.view-pc .wrap{max-width:900px;}

h1{font-size:18px;}

input{
  width:100%;
  padding:10px;
  margin-bottom:8px;
  border-radius:10px;
  border:1px solid #ccc;
}

button{
  padding:10px;
  border-radius:10px;
  border:none;
}

.primary{background:#111;color:#fff;}
.ghost{background:#eee;}

.out{
  margin-top:10px;
  padding:14px;
  border-radius:14px;
  background:#fff;
}

.big{
  font-size:18px;
  font-weight:bold;
}

.ok{color:green;}
.warn{color:red;}
</style>
</head>

<body class="view-mobile">

<div class="wrap">

<h1>PSAåˆ©ç›Šè¨ˆç®—ãƒ„ãƒ¼ãƒ«</h1>

<div class="viewbar">
  <div>
    <button id="btnMobile" class="segbtn active">ã‚¹ãƒãƒ›</button>
    <button id="btnPC" class="segbtn">PC</button>
  </div>
  <button id="copyBtn">çµæœã‚³ãƒ”ãƒ¼</button>
</div>

<input id="card" type="number" placeholder="ã‚«ãƒ¼ãƒ‰ä»£">
<input id="grading" type="number" placeholder="é‘‘å®šè²»ç”¨">
<input id="n" type="number" placeholder="æšæ•°">
<input id="rate10" type="number" placeholder="PSA10ç‡%">
<input id="p10" type="number" placeholder="PSA10è²·å–">
<input id="p9" type="number" placeholder="PSA9è²·å–">
<input id="target" type="number" placeholder="ç›®æ¨™åˆ©ç›Š">

<div style="display:flex;gap:8px;margin-top:8px;">
<button id="calc" class="primary">è¨ˆç®—</button>
<button id="fill" class="ghost">ä¾‹</button>
</div>

<div id="out" class="out">çµæœãŒã“ã“ã«å‡ºã¾ã™</div>

</div>

<script>
function calc(){
  const c=+card.value;
  const g=+grading.value;
  const n=Math.max(1,+n.value);
  const r10=+rate10.value;
  const p10=+p10.value;
  const p9=+p9.value;
  const target=+target.value;

  const cost=c+g;
  const diff=p10-p9;

  let yMax;
  if(diff<=0){yMax=n;}
  else{
    const profitAll10=n*p10-n*cost;
    yMax=Math.floor((profitAll10-target)/diff);
    yMax=Math.max(0,Math.min(n,yMax));
  }

  const min10=n-yMax;
  const needRate=(min10/n*100).toFixed(1);

  const exp10=n*(r10/100);
  const exp9=n-exp10;
  const expProfit=exp10*p10+exp9*p9-n*cost;

  const ok=expProfit>=target;

  out.innerHTML=`
  <div class="big ${ok?'ok':'warn'}">
  PSA9ã¯ ${yMax}æšã¾ã§OK
  </div>
  å¿…è¦PSA10ç‡ ${needRate}%<br>
  æœŸå¾…åˆ©ç›Š ${Math.round(expProfit)}å††
  `;
}

calc.onclick=calc;

fill.onclick=()=>{
  card.value=3000;
  grading.value=2500;
  n.value=10;
  rate10.value=60;
  p10.value=12000;
  p9.value=6000;
  target.value=0;
  calc();
};

copyBtn.onclick=()=>{
  navigator.clipboard.writeText(out.innerText);
  alert("ã‚³ãƒ”ãƒ¼ã—ãŸã§ğŸ‘");
};

btnMobile.onclick=()=>{
  document.body.className="view-mobile";
  btnMobile.classList.add("active");
  btnPC.classList.remove("active");
};

btnPC.onclick=()=>{
  document.body.className="view-pc";
  btnPC.classList.add("active");
  btnMobile.classList.remove("active");
};
</script>

</body>
</html>
